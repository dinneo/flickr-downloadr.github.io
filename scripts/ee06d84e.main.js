"use strict";var fdScripts=function(){return{stripString:function(a,b){var c=a.indexOf(b);return-1!==c?a.slice(0,c)+a.substr(c+b.length):a},truncateString:function(a,b){var c=a.indexOf(b);return-1!==c?a.slice(0,c):a},getJSON:function(a,b){$.ajax({url:a,type:"GET",dataType:"json",success:b,error:function(a){console.log("Ajax Error: %s",a)}})},gaTrack:function(a,b,c,d,e){window.ga&&(void 0!==e?window.ga("send","event",a,b,c,d,e):void 0!==d?window.ga("send","event",a,b,c,d):window.ga("send","event",a,b,c))}}}();$(function(){Detectizr.detect({detectScreen:!1}),Handlebars.registerHelper("is_release",function(a,b){return 0===a.indexOf("Released ")&&"The CI Bot"===b?" fd-release-commit":"fd-commit"}),Handlebars.registerHelper("strip_sign",function(a,b){var c=fdScripts.truncateString(a,"Signed-off-by:");return c=fdScripts.stripString(c,"[skip ci]"),c=fdScripts.stripString(c,"[ci skip]"),c=fdScripts.stripString(c,"[deploy]"),c=c.length>b-1?c.slice(0,b)+"...":c}),Handlebars.registerHelper("format_date",function(a){var b=new Date(a);return b.toLocaleDateString()}),Handlebars.registerHelper("format_date_time",function(a){var b=new Date(a);return b.toLocaleDateString()+" "+b.toLocaleTimeString()}),Handlebars.registerHelper("fix_github_url",function(a){if(!a)return a;var b=a.replace("https://api.github.com/users/","https://github.com/");return b=b.replace("https://api.github.com/repos/","https://github.com/"),b.replace("/commits/","/commit/")});var a=Detectizr.os.name,b='fdScripts.gaTrack("Files", "Download", "flickr downloadr %PLATFORM% (home)");',c='fdScripts.gaTrack("Files", "Download", "flickr downloadr %PLATFORM% (downloads)");',d=$("#social-icons"),e={installerPath:"/installer/linux-x64/flickrdownloadr_%VERSION%-0_amd64.deb",installerFile:"flickrdownloadr_%VERSION%-0_amd64.deb"},f={installerPath:"/installer/linux-x64/flickrdownloadr-%VERSION%-0.x86_64.rpm",installerFile:"flickrdownloadr-%VERSION%-0.x86_64.rpm"},g={windows:{name:"Windows",commonName:"Windows",shortName:"win",iconName:"fa-windows",installerPath:"/installer/windows/flickrdownloadr-%VERSION%-windows-installer.exe",installerFile:"flickrdownloadr-%VERSION%-windows-installer.exe"},osx:{name:"Mac OS X",commonName:"Mac OS X",shortName:"osx",iconName:"fa-apple",installerPath:"/installer/osx/flickrdownloadr-%VERSION%-osx-installer.app.dmg",installerFile:"flickrdownloadr-%VERSION%-osx-installer.app.dmg"},linux:{name:"Linux",commonName:"Linux",shortName:"linux",iconName:"fa-linux",installerPath:"/installer/linux/flickrdownloadr-%VERSION%-linux-installer.run",installerFile:"flickrdownloadr-%VERSION%-linux-installer.run"},"linux-x64":{name:"64-bit Linux",commonName:"Linux",shortName:"linux",iconName:"fa-linux",installerPath:"/installer/linux-x64/flickrdownloadr-%VERSION%-linux-x64-installer.run",installerFile:"flickrdownloadr-%VERSION%-linux-x64-installer.run"}},h={facebook:{title:"Like us on Facebook",href:"https://www.facebook.com/flickrdownloadr"},flickr:{title:"Follow us on flickr",href:"http://www.flickr.com/photos/_floydpink_"},gmail:{title:"Send us an email",href:"mailto:contact.us@flickrdownloadr.com"},"google+":{title:"Follow us on Google+",href:"https://plus.google.com/u/0/112082983921398252462/about"},pinterest:{title:"Follow us on Pinterest",href:"http://pinterest.com/flickrdownloadr/"},twitter:{title:"Follow us on Twitter",href:"https://twitter.com/FlickrDownloadr"},youtube:{title:"Follow us on YouTube",href:"http://www.youtube.com/user/flickrdownloadr"},github:{title:"Fork us on GitHub",href:"https://github.com/flickr-downloadr"}};d.find("a").each(function(){var a=$(this).attr("class");$(this).attr("target","_blank").attr("onclick","fdScripts.gaTrack('External', 'Click', 'Social ("+a+")');"),$(this).attr("title",h[a].title).attr("href",h[a].href),"gmail"===a&&$(this).attr("target","_self")}),"linux"===a&&"64bit"===Detectizr.os.addressRegisterSize?a="linux-x64":"android"===a||"blackberry"===a?a="linux":("mac os"===a||"ios"===a)&&(a="osx"),$.get("/build.number",function(d){var h=$(".fd-version");$(".fd-version-text").text(d),$(".fd-version-quote").fadeIn();var i=g[a];i||(i=g.windows,a="windows");var j=$("#fd-download-button");j.attr("onClick",b.replace("%PLATFORM%",i.name)),j.attr("href",i.installerPath.replace("%VERSION%",d)),$("#fd-download-platform-name").text(i.name),$("#fd-download-platform-icon").addClass(i.iconName),$("#fd-installer").fadeIn(),$.each(["windows","osx","linux","linux-x64"],function(a,b){var e=g[b];$("#fd-installer-"+b+"-file").text(decodeURIComponent(e.installerFile.replace("%VERSION%",d)));var f=$("#fd-installer-download-"+b+"-button");f.attr("onClick",c.replace("%PLATFORM%",e.name)),f.attr("href",e.installerPath.replace("%VERSION%",d))}),$("#fd-installer-deb-file").text(e.installerFile.replace("%VERSION%",d));var k=$("#fd-installer-deb");k.attr("onClick",c.replace("%PLATFORM%","linux-deb")),k.attr("href",e.installerPath.replace("%VERSION%",d)),$("#fd-installer-rpm-file").text(f.installerFile.replace("%VERSION%",d));var l=$("#fd-installer-rpm");l.attr("onClick",c.replace("%PLATFORM%","linux-rpm")),l.attr("href",f.installerPath.replace("%VERSION%",d)),$("#fd-installer-download-"+a+"-button").removeClass("btn-warning").addClass("btn-success"),$('a[href="#fd-installer-'+i.shortName+'"]').tab("show"),$("#fd-installer-section-column").fadeIn();var m=$("#fd-hidden-slides"),n=$(".fd-screenshots-carousel"),o=$("#fd-screenshot-header-platform");o.find("span").text(i.commonName),o.find("a").on("click",function(){return n.find(".carousel-inner").append(m.find(".item").detach()),n.find(".carousel-inner").find(".item").each(function(){var a,b=$(this);b.hasClass("win")?a=" (Windows)":b.hasClass("osx")?a=" (Mac OS X)":b.hasClass("linux")&&(a=" (Linux)"),b.find("h4").text(b.find("h4").text()+a)}),o.fadeOut(),!1}),"win"!==i.shortName&&(m.append(n.find(".win.item").detach()),m.find(".item").removeClass("active"),n.find(".carousel-inner").append(m.find("."+i.shortName+".item").detach()),n.find(".item").first().addClass("active")),fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/git/refs/tags/v"+d,function(a){fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/git/tags/"+a.object.sha,function(a){var b=$("<abbr></abbr>").attr("title",a.tagger.date).text(" ("+new Date(a.tagger.date).toLocaleDateString()+")").addClass("timeago");h.append($("<span></span>").addClass("fd-released").append($("<span></span>").text(" - ")).append(b)),$("abbr.timeago").timeago()})})}),$(document).on("click","#getCommits",function(){$("#commitsContainer").empty().append($('<div><span class="muted">Loading...</span></div>')),fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/commits",function(a){var b="<table> <thead>   <th class='fd-commitmessage'>Message</th>   <th class='fd-commitname'>Author</th>   <th class='fd-commitdate'>Date</th> </thead> <tbody> {{#commitsarray}}   <tr class='{{is_release commit.message commit.author.name}}'>     <td class='fd-commitmessage'>       <span>{{strip_sign commit.message 40}}</span>       <span>         <a href='{{fix_github_url url}}' title='{{format_date_time commit.author.date}}' target='_blank'> &raquo;</a>       </span>     </td>     <td class='fd-commitname'>       <a href='{{fix_github_url author.url}}' target='_blank'>{{strip_sign commit.author.name 15}}</a>     </td>     <td class='fd-commitdate'>       <abbr class='timeago' title='{{commit.author.date}}'>{{format_date commit.author.date}}</abbr>     </td>   </tr> {{/commitsarray}} </tbody></table>",c={commitsarray:a},d=Handlebars.compile(b)(c);$("#commitsContainer").empty().append(d),$("abbr.timeago").timeago()})}),$("#fd-slideshow-dialog").find("img").wrap(function(){return'<a href="'+$(this).attr("src")+'" target="_blank" title="Click to see actual size" />'})});